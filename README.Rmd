# mongolitedt

[![Build Status](https://travis-ci.org/SymbolixAU/mongolitedt.svg?branch=master)](https://travis-ci.org/SymbolixAU/mongolitedt)
[![Coverage Status](https://codecov.io/github/SymbolixAU/mongolitedt/coverage.svg?branch=master)](https://codecov.io/github/SymbolixAU/mongolitedt?branch=master)
[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/mongolitedt)](http://cran.r-project.org/package=mongolitedt)
[![CRAN RStudio mirror downloads](http://cranlogs.r-pkg.org/badges/mongolitedt)](http://cran.r-project.org/web/packages/mongolitedt/index.html)
[![Github Stars](https://img.shields.io/github/stars/SymbolixAU/mongolitedt.svg?style=social&label=Github)](https://github.com/SymbolixAU/mongolitedt)

Extends `mongolite` with `finddt()` and `aggregatedt()` that return `data.table` objects. 

`finddt` and `aggregate` are faster implementations of `find` and `aggregate`.

**Important**

To use these functions the query sent to mongodb **must** return data that can be coerced into a data.table (using `data.table::rbindlist`)



## Useage

Define a mongolite::mongo connection object 

`mongo <- mongolite::mongo(collection = "test", db = "test", url = "mongodb://localhost")`

Then call `bind_mongolitedt(mongo)` to bind the `finddt()` and `aggregatedt()` functions

Then use the functions as you would standard `mongolite` functions:

`mongo$finddt(limit = 10)` returns 10 rows of a data.table

some quick benchmarks:

 - `mongo$find` 1,000,000 documents at pagesize 100000 ~30 seconds.
 - `mongo$finddt` 1,000,000 documents at pagesize 100000 ~10 seconds
 
 - `mongo$find`   - 5,000,000 documents at pagesize 100000 ~157 seconds
 - `mongo$finddt` - 5,000,000 documents at pagesize 100000 ~60 seconds


